<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Experiment Semantics</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre&display=swap" rel="stylesheet">
    <style type="text/css">
        body {
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }

        input {
            margin: 2px;

        }


        #content {
            position: absolute;
            /* text-align: center; 让div内部文字居中*/
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #btn {
            font-family: Arial, Helvetica, sans-serif;
        }
    </style>

</head>

<body>
    <div id="content">

        <div>
            Magic number: <span id="res"></span>
        </div>
        <form id="form1" action="##" method="post">
            <input id="arg1" name="arg1" type="text">
            <br>
            <input id="arg2" name="arg2" type="text">
            <br>
            <input id="btn" type="button" onclick="magic()" value="Spell">
        </form>
    </div>


    <script type="text/javascript">

        function getFormData($form) {
            var unindexed_array = $form.serializeArray();
            var indexed_array = {};

            $.map(unindexed_array, function (n, i) {
                indexed_array[n['name']] = n['value'];
            });

            return indexed_array;
        }

        function getArrayInputData() {
            var data = {};
            data.input = $('#arg1').val().trim();
            data.array = $('#arg2').val().trim().split(' ');    

            return data;
        }

        function api3() {
            var inputData = getArrayInputData();
            $.ajax({
                //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                contentType: 'application/json;charset=UTF-8',
                url: "/api_3",//url
                data: JSON.stringify(inputData),
                success: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)       

                },
                error: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)                    
                }
            });
        }


        function api2() {
            $.ajax({
                //几个参数需要注意一下
                type: "POST",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                contentType: 'application/json;charset=UTF-8',
                url: "/api_2",//url
                data: JSON.stringify(getFormData($("#form1"))),
                success: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)       
                    $('#res').html(result.res);

                    $('#arg1').val('');
                    $('#arg2').val('');
                },
                error: function (result) {
                    console.log(sresult);//打印服务端返回的数据(调试用)                    
                }
            });
        }

        function magic() {
            api3();
        }

        $('#form1').keydown(function (e) {
            var key = e.which;
            if (key == 13) {
                magic();
                // magicArray();
            }
        });

    </script>

</body>

</html>